## システム全体の構成と流れ（ざっくり解説）

このプロジェクトは「学校端末OS＋管理スイート」を目指して、Ubuntu 24.04ベースで全部入りのセットアップを自動化する仕組みです。


**なお、Sis-UI以外は完全にテストしていません。** 今後パッチをどんどん当てていきます。

**特に、MDM関連については低レベルの(ベースの)コンポネントのみです。**

**そして、コメントや各所に生成AIを使用しています。使用LLMはQwen3 coderです。生成AIアレルギーの方（？）はお気おつけください**


テストしたと言っても、録画中などのちょっと違う環境だとバグったり、他の環境になるとバグるかも。テストできる端末が１つしかないのと時間が足らなかったので。すみません。

### 1. 何が入ってる？
- **OS本体**: Ubuntu 24.04 Desktop（公式ISOをカスタマイズ）
- **SIS UI**: React+Tauri製の独自デスクトップ環境。コマンドパレットやAI連携、ホットコーナー、円形メニューなど「使う人」向けの体験重視。
- **MDM（端末管理）サーバ＆エージェント**: Flask製サーバ＋Bashエージェントで、端末登録・ポリシー配布・コマンド実行・ファイル配布/回収・画面ロック・Broadcastなどを実現。
- **インストーラ/セットアップスクリプト**: `install.sh` で全部まとめて導入。監査・ログ・DNSフィルタ・自動更新・リモートワイプ・授業用Veyonなども一括で入る。
- **ISOビルド＆VMテスト用スクリプト**: `tools/make-iso.sh` でカスタムLive ISOを作り、`tools/vm-helper.sh` でQEMU上で自動テストできる。

### 2. どうやって（正しく動かせれたら）動く？
1. まず `install.sh` を実行すると、
	- 必要なパッケージや監査/ログ/フィルタ/MDM/自動更新など全部セットアップ。
	- `/usr/local/sis/` に各種エージェントや補助スクリプトを配置。
	- systemdサービス・タイマーで定期的にMDMチェックインやポリシー適用、リモートワイプなどを自動化。
	- デスクトップ環境（SIS UI）は `DE-deploy.sh` で配備。
2. MDMサーバ（`mdm_server/server.py`）を起動しておくと、
	- 端末側の `mdm-agent.sh` から enroll/checkin/poll/apply などのAPIリクエストが飛ぶ。
	- サーバは端末ごとにポリシーやコマンド、ファイル配布/回収、画面ロック/Broadcastなどを管理。
	- 管理者・教師用の簡易GUI（PyQt5製）も用意。
3. SIS UI（`sis-ui/`）はReact+Tauriで作成。
	- コマンドパレット（Ctrl+PやAlt+Space短押し）、円形メニュー（Alt+Space長押し）、ホットコーナー、AI連携など独自の体験。
	- GNOMEやXfceのセッションとしても動くし、autostartで常駐も可能。

### 3. 工夫したポイント
- **全部自動化**: 1コマンドで「監査・ログ・フィルタ・MDM・DE」まで一気に入る。ISO化もスクリプトで再現。
- **体験重視UI**: SIS UIは「使う人が楽しい・便利」を最優先。AI連携やホットコーナー、円形メニューなど直感的な操作を重視。
- **MDMはPoCから拡張前提**: サーバ・エージェントともにシンプルな構成で、現場の要望に応じて機能追加しやすい設計。
- **セキュリティ配慮**: 監査・ログ・リモートワイプ・データ保護（umask/外部媒体制限）など、学校現場で必要な安全策も一通りカバー。
- **Live ISO体験重視**: まずは「触って分かる」ことを優先し、Live起動でSIS UIや管理機能をすぐ試せる。

### 4. 雰囲気を味わおう｛動作確認済み｝
1. Ubuntu 24.04を用意して `package_install.sh` を実行
2.  `try-deploy.sh` を実行


実機でデスクトップ環境が触れます。閉じるには再起動とか、ミッションセンターからkillしてください。

### 5. デスクトップ環境を入れよう｛動作確認済み｝
1. Ubuntu 24.04を用意して `package_install.sh` を実行
2.  `DE-deploy.sh` を実行
3. 再起動して、「sis-ui(xorg)」を選択(一番安定)


時間がなくて、install.sh等はテストできていません。


提出が思っとったより２日早くて悲しい。気づいたの当日の19時。開発期間２週間。ガチったのは最後の3日間。

---
細かい実装やコマンド例は `readme.md` や各スクリプトの先頭コメントも参照してください。
